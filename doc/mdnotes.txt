*mdnotes.txt*         Markdown Notes for Neovim (mdnotes.nvim)

Authors:
    Yiannis Michael (yimich9963)
                                       Type |gO| to see the table of contents.

==============================================================================
INTRODUCTION						*mdnotes-intro*

Markdown Notes (mdnotes or Mdn) is a plugin that aims to improve the Neovim
Markdown note-taking experience by providing features like better Wikilink
support, adding/removing hyperlinks to images/files/URLs, file history, asset
management, referencing, and formatting. All this without relying
on any LSP but using one is recommended.

==============================================================================
QUICK START            	             			*mdnotes-quickstart*

To setup `mdnotes` using the Lazy package manager, put this in your `init.lua` file,
>lua
    {
	"ymich9963/mdnotes.nvim",
    }

optionally specifying all the path and file options will allow you to use all
the commnds,
>lua
    {
	"ymich9963/mdnotes.nvim",
	opts = {
	    assets_path = "assets",
	    index_file = "MAIN.md",
	    journal_file = "JOURNAL.md",
	}
    }

Install and then setup using,
>lua
    require('mdnotes.config').setup({opts})

Explanation for the options is given in the next |mdnotes-config| section.
See |mdnotes-keymaps| for keymap recommendations, |mdnotes-lsp| for notes on
using LSPs with `mdnotes`, and |mdnotes-completion| for using file name
completion.

==============================================================================
KEYMAPS            	             			*mdnotes-keymaps*

The default keymaps are listed below and they can be enabled using 
|mdnotes-default_keymaps|. They follow a `<leader>m` prefix.
>lua
    vim.keymap.set('n', '<leader>mgx', ':Mdn open<CR>', { buffer = true, desc = "Open URL or file under cursor" })
    vim.keymap.set('n', '<leader>mgf', ':Mdn wikilink_follow<CR>', { buffer = true, desc = "Open markdown file from WikiLink" })
    vim.keymap.set('n', '<leader>mgrr', ':Mdn wikilink_show_references<CR>', { buffer = true, desc = "Show references of link or buffer" })
    vim.keymap.set('n', '<leader>mgrn', ':Mdn wikilink_rename_references<CR>', { buffer = true, desc = "Rename references of link or current buffer" })
    vim.keymap.set({"v", "n"}, "<leader>mk", ":Mdn hyperlink_toggle<CR>", { buffer = true, desc = "Toggle hyperlink" })
    vim.keymap.set("n", "<leader>mh", ":Mdn history_go_back<CR>", { buffer = true, desc = "Go to back to previously visited Markdown buffer" })
    vim.keymap.set("n", "<leader>ml", ":Mdn history_go_forward<CR>", { buffer = true, desc = "Go to next visited Markdown buffer" })
    vim.keymap.set({"v", "n"}, "<leader>mb", ":Mdn bold_toggle<CR>", { buffer = true, desc = "Toggle bold formatting" })
    vim.keymap.set({"v", "n"}, "<leader>mi", ":Mdn italic_toggle<CR>", { buffer = true, desc = "Toggle italic formatting" })

Note: It is highly recommended you have your keymaps in your
`after/ftplugin/markdown.lua` file to keep them specific to Markdown files.

==============================================================================
LSP            	             				*mdnotes-lsp*

This plugin is designed to work with Markdown LSPs by trying to fill the gaps
and to also complement their current functionality. Please see the table in
the README for how `mdnotes` tries to work with LSPs and Neovim itself.

Quick tip is if you don't want your Markdown LSP to show diagnostics you can
disable LSP diagnostics per filetype by using this in your
`after/ftplugin/markdown.lua` file.
>lua
    vim.diagnostic.enable(false, { bufnr = 0 })

==============================================================================
COMPLETION            	         			*mdnotes-completion*

Built-in file path completion with Neovim can be used with `mdnotes` which
also means that you don't need an LSP for this either. Execute the completion
by typing the path and in insert mode pressing |i_CTRL-X_CTRL-F|.

For Windows, due to the square brackets being in |'isfname'|, you need to
remove them for autocompletion to work. Therefore I've setup this keymap so
that it gets and unset automatically on file completion. Place the snippet
below in your `after/ftplugin/markdown.lua`,
>lua
    vim.keymap.set("i", "<C-x><C-f>", "<cmd>set isfname-=[,]<CR><C-x><C-f><cmd>set isfname+=[,]<CR>",
    {
        desc = "Mdnotes i_CTRL-X_CTRL-F smart remap to allow path completion on Windows",
	buffer = true
    })

==============================================================================
CONFIG             	                     	      	*mdnotes-config*

The default config for `mdnotes` is shown below,
>lua
    {
	index_file = "",
	journal_file = "",
	assets_path = "",
	insert_file_behaviour = "copy",
	overwrite_behaviour = "error",
	open_behaviour = "buffer",
	bold_format = "**",
	italic_format = "*",
	date_format = "%a %d %b %Y",
	prefer_lsp = false,
	auto_list = true,
	default_keymaps = false,
	table_best_fit_padding = 0,
    }
<
index_file = `"path"`					*mdnotes-index_file*

    Can be any path to your index file which is then accessed by |:Mdn-home|.

journal_file = `"path"`					*mdnotes-journal_file*

    Can be any path to your journal file which is then accessed by |:Mdn journal|.

assets_path = `"path"`					*mdnotes-assets_path*

    Can be any path to your assets folder. This is where any asset you insert
    by using |:Mdn insert_image| or |:Mdn insert_file| is copied or moved to.

insert_file_behaviour = `"string"`			*mdnotes-insert_file_behaviour*

    Can take the values of `"copy"` or `"move"` which copies or moves inserted
    assets respectively.

overwrite_behaviour = `"string"`			*mdnotes-overwrite_behaviour*

    Can take the values of `"error"` or `"overwrite"` which defines how the plugin 
    should handle existing assets. With `"error"` it throws an error and prevents
    the user from inserting the asset. With `"overwrite"` it will overwrite the
    conflicting file.

open_behaviour = `"string"`				*mdnotes-open_behaviour*

    Can take the values of `"buffer"` or `"tab"` which defines how Wikilinks are
    opened using |:Mdn home|, |:Mdn journal|, and |:Mdn wikilink_follow|. With
    `"buffer"` it opens them in the current buffer, whereas with `"tab"` it opens them
    in a new tab.

bold_format = `"string"`				*mdnotes-bold_format*

    Can take the valid values of `"**"` or `"__"` which defines how the
    Markdown `**bold**` or `__bold__` formatting is executed.

italic_format = `"string"`				*mdnotes-italic_format*

    Can take the valid values of `"*"` or `"_"` which defines how the
    Markdown `*italic*` or `_italic_` formatting is executed.

date_format = `"string"`				*mdnotes-date_format*

    Format of the outputed date using |Mdn-journal_insert_entry|. See |strftime()| for
    acceptable formats.

prefer_lsp = `false|true`				*mdnotes-prefer_lsp*

    Choose whether to prefer to use the LSP functions instead of the `mdnotes`
    functions, when an LSP server is detected in the current Markdown buffer.

auto_list = `false|true`				*mdnotes-auto_list*

    Choose whether to allow automatic continuation of your unordered/ordered/
    task list. Works by remapping |<CR>|, |o|, and |O| but only in Markdown
    buffers by specifying it in the plugin's `after/ftplugin/markdown.lua`
    directory.

default_keymaps = `false|true`				*mdnotes-default_keymaps*

    Enable or disable the default keymaps listed in |mdnotes-keymaps|.

table_best_fit_padding = `integer`			*mdnotes-table_best_fit_padding*

    Number of spaces to add around the table cells when doing |Mdn-table_best_fit|.

==============================================================================
COMMANDS                                         	*mdnotes-commands*

The Mdnotes plugin uses subcommands through calling `:Mdn <sub command>`. The
subcommands are listed below.

:Mdn home 	                                       	*:Mdn-home*

    Opens the index file depending on |mdnotes-open_behaviour|

:Mdn journal 	                                      	*:Mdn-journal*

    Opens the journal file depending on |mdnotes-open_behaviour|

:Mdn open 	                                      	*:Mdn-open*

    Opens the asset under the cursor. Uses |vim.ui.open()| but due to a bug for
    Winows it's currently using, >lua
	vim.system({"cmd.exe", "/c", "start", link}) 

:Mdn outliner_toggle					*:Mdn-outliner_toggle*

    Toggle an outliner mode (similar to programs like Logseq). This command
    essentially creates or deletes certain keymaps to create the outliner mode.

:Mdn wikilink_follow 					*:Mdn-wikilink_follow*

    Open the Wikilink (e.g. `[[link]]` or `[[link#section]]`) under the cursor. 

:Mdn wikilink_show_references 				*:Mdn-wikilink_show_references*

    Show the references of the current Wikilink under cursor in a quickfix
    list. If no Wikilink is under the cursor it shows the references to the
    current buffer.

:Mdn wikilink_rename_references				*:Mdn-wikilink_rename_references*

    Rename the reference to a `[[link]]` and also the file pointing to that
    link. If executed when not hovering over a link, it will prompt to rename
    current buffer and file references.

:Mdn wikilink_undo_rename				*:Mdn-wikilink_undo_rename*

    Undo the most recent reference rename. Only available when 
    `prefer_lsp = false`. 

:Mdn insert_image					*:Mdn-insert_image*

    Insert the image in the clipboard under the cursor and depending on
    |mdnotes-insert_file_behaviour| place it in your |mdnotes-assets_path|. (e.g
    `![image](path/to/assets/image.png)`). Overwriting depends on
    |mdnotes-overwrite_behaviour|.

:Mdn insert_file					*:Mdn-insert_file*

    Exactly the same as |Mdn-insert_image| but it inserts a hyperlink to the
    file (e.g. `[file](path/to/assets/file.txt)`).

:Mdn assets_cleanup_unused				*:Mdn-assets_cleanup_unused*

    Cleanup unused assets in your |mdnotes-assets_path|. A |vim.ui.input()|
    will be used to prompt for `y/n/a(ll)` or `cancel` deletion actions. Uses
    |vim.fs.rm()|.

    Note: Data loss will obviously happen with this command so BE CAREFUL.

:Mdn assets_move_unused					*:Mdn-assets_move_unused*

    Move unused assets in your |mdnotes-assets_path| to an `../unused_assets/` 
    folder relative to your assets folder. A |vim.ui.input()| will be used 
    to prompt for `y/n/a(ll)` or `cancel` deletion actions. Uses |vim.fs.rm()|.

:Mdn history_go_back					*:Mdn-history_go_back*

    Go back to the previously visited Markdown buffer.

:Mdn history_go_forward					*:Mdn-history_go_forward*

    Go forward to the Markdown buffer you were in before you went back.

:Mdn history_clear					*:Mdn-history_clear*

    Clear the history of visited Markdown buffers.

:Mdn hyperlink_toggle 					*:Mdn-hyperlink_toggle*

    Toggle inserting and deleting a hyperlink (e.g. `[text](link)`) from your
    clipboard (the `"+` register).

:Mdn bold_toggle					*:Mdn-bold_toggle*

    Toggle Markdown `**bold**` syntax. Select a word and execute the command
    or hover over already bold text to remove.

:Mdn italic_toggle					*:Mdn-italic_toggle*

    Toggle Markdown `*italic*` syntax. Select a word and execute the command
    or hover over already bold text to remove.

:Mdn strikethrough_toggle				*:Mdn-strikethrough_toggle*

    Toggle Markdown `~~strikethrough~~` syntax. Select a word and execute the 
    command or hover over already bold text to remove.

:Mdn inline_code_toggle					*:Mdn-inline_code_toggle*

    Toggle Markdown `inline code` (``) syntax. Select a word and execute the command
    or hover over already bold text to remove.

:Mdn task_list_toggle					*:Mdn-task_list_toggle*

    Toggle through checked, unchecked, and no checkbox in a list item. Also works
    with |linewise-visual|.

:Mdn journal_insert_entry				*:Mdn-journal_insert_entry*

    Insert at the top of the file the current date and time along with a separator.
    Useful when using a journal.

:Mdn toc_generate					*:Mdn-toc_generate*

    Generate and insert a Table Of Contents of the current file at the cursor 
    position.

:Mdn table_create {rows} {cols}				*Mdn-table_create*

   Create a table of the size {rows} x {cols}. It will get populated with
   `ROWrCOLc` text automatically. For example on a 3 x 3 table, it would be, 
>
    |1r1c|1r2c|1r3c|
    |----|----|----|
    |2r1c|2r2c|2r3c|
    |3r1c|3r2c|3r3c|

:Mdn table_best_fit					*Mdn-table_best_fit*

   Set the best fit for the table columns so that all cell borders line up.
   Can also add padding to your cells. See |mdnotes-table_best_fit_padding|.

:Mdn table_column_insert_left				*Mdn-table_column_insert_left*

   Insert a column to the left of the current column you're in.

:Mdn table_column_insert_right				*Mdn-table_column_insert_right*

   Insert a column to the right of the current column you're in.

==============================================================================
API                                     		*mdnotes-api*

`mdnotes` most of the commands is just calling their corresponding functions.
Some of the descriptions here are copied from the |mdnotes-commands| section.

setup({opts})                                          	*mdnotes.setup()*

    Configure installation with non-default options. Not needed if using
    defaults. See |mdnotes-config| for a more in-depth explanation.

    Parameters: ~
    • {opts}  `(table?)` Optional parameters:
              • {index_file} (`string?`, default `""`)
		path to index file.
              • {journal_file} (`string?`, default `""`)
		path to journal file.
              • {assets_path} (`string?`, default `""`)
		path to assets directory.
              • {insert_file_behaviour} (`string?`, default `"copy"`)
		`mdnotes` behaviour when inserting files.
              • {overwrite_behaviour} (`string?`, default `"copy"`)
		`mdnotes` behaviour when inserting files and the file already
		exists.
              • {open_behaviour} (`string?`, default `"copy"`)
		`mdnotes` behaviour when opening files with |:Mdn-open|.
              • {bold_format} (`string?`, default `"**"`)
		defines `mdnotes` bold formatting behaviour
              • {italic_format} (`string?`, default `"*"`)
		defines `mdnotes` italic formatting behaviour
              • {date_format} (`string?`, default `"%a %d %b %Y"`)
		defines the date format used when inserting a journal entry.
		See |strftime|.
              • {prefer_Lsp} (`false|true`, default `false`)
		prefer using the installed Markdown LSP functions instead of
		the `mdnotes` implementations.
              • {auto_list} (`false|true`, default `true`)
		auto-continue the Markdown lists. See |mdnotes-auto_list|.
              • {default_keymaps} (`false|true`, default `false`)
		use the default keymaps.

go_to_index_file() 			   		*mdnotes.go_to_index_file()*

    Go the index file defined by |mdnotes-index_file|.

go_to_journal_file()					*mdnotes.go_to_journal_file()*

    Go the journal file defined by |mdnotes-journal_file|.

journal_insert_entry()					*mdnotes.journal_insert_entry()*

    Insert a journal entry at the top of the file, which is the current date 
    along with a separator to separate the different entries. Places the 
    cursor on `<cursor>`. For example,
>markdown
    ```
    ## Sun 09 Nov 2025

    <cursor>

    ---
    ```

open() 							*mdnotes.open()*

    Open the hyperlink under cursor. It can be a file or a URL.

toggle()						*mdnotes.outliner.toggle()*

    Toggle the outliner mode. Outliner mode essentially sets or deletes
    certain keymaps to simulate working in an outliner program (e.g. Logseq).

follow()						*mdnotes.wikilinks.follow()*

    Open Wikilink under cursor (e.g. `[[link#section]]`).

show_references()					*mdnotes.wikilinks.show_references()*

    Show the references of the current Wikilink under cursor in a quickfix
    list. If no Wikilink is under the cursor it shows the references to the
    current buffer.

rename_references()					*mdnotes.wikilinks.rename_references()*

    Rename the reference to a `[[link]]` and also the file pointing to that
    link.

rename_references_cur_buf()				*mdnotes.wikilinks.rename_references_cur_buf()*

    Rename references to current buffer and also the file of the current
    buffer.

undo_rename						*mdnotes.wikilinks.undo_rename()*

    Undo the most recent reference rename. Only available when 
    `prefer_lsp = false`. 

check_md_format({pattern}) 				*mdnotes.check_md_format()*

    Check if the text under cursor obeys a Lua pattern that is used to
    describe Markdown formatting. Patterns used are the
    |mdnotes.format_patterns|.

    Parameters: ~
    • {pattern}  `(string?)` A Lua pattern that also returns cursor position
      at the start and end.

    Return: ~
      (`false|true`)

check_assets_path() 					*mdnotes.assets.check_assets_path()*

    Check the existance of the |mdnotes-assets_path| when inserting images or
    files.

    Return: ~
      (`false|true`)

insert_image()						*mdnotes.assets.insert_image()*

    Insert the image in the clipboard under the cursor and depending on
    |mdnotes-insert_file_behaviour| place it in your |mdnotes-assets_path|. (e.g
    `![image](path/to/assets/image.png)`). Overwriting depends on
    |mdnotes-overwrite_behaviour|.


insert_file()						*mdnotes.assets.insert_file()*

    Exactly the same as |mdnotes.insert_image()| but it inserts a hyperlink to the
    file (e.g. `[file](path/to/assets/file.txt)`).

cleanup_unused()					*mdnotes.assets.cleanup_unused()*

    Cleanup unused assets in your |mdnnote-assets_path|. A |vim.ui.input()|
    will be used to prompt for `y/n/a(ll)` or `cancel` deletion actions. Uses
    |vim.fs.rm()|.

    Note: Data loss will obviously happen with this command so BE CAREFUL.

move_unused()						*mdnotes.assets.move_unused()*

    Move unused assets in your |mdnnote-assets_path| to an `../unused_assets/` 
    folder relative to your assets folder. A |vim.ui.input()| will be used 
    to prompt for `y/n/a(ll)` or `cancel` move actions. Uses |uv.fs_rename()|.

buf_history						*mdnotes.history.buf_history*

    Table containing the sequential buffer history of the visited Markdown
    buffers. It gets populated through an `autocmd` on a `BufEnter` event. If
    the user goes back and then goes forward to buffer that they were not
    previously in, the buffer history removes everything past the buffer they
    went back to, and appends the buffer they've moved forward to.

current_index						*mdnotes.history.current_index*

    Current index being pointed to in the |mdnotes.buf_history| table. 

go_back()						*mdnotes.history.go_back()*

    Go back in the buffer history. Essentially move the index by -1. See
    |mdnotes.buf_history|.

go_forward()						*mdnotes.history.go_forward()*

    Go forward in the buffer history. Essentially move the index by +1. See
    |mdnotes.buf_history|.

clear_history()						*mdnotes.history.clear_history()*

    Clear the |mdnotes.buf_history| table.

hyperlink_insert()					*mdnotes.formatting.hyperlink_insert()*

    Insert a hyperlink from the clipbaord using the currently highlighted
    word.

hyperlink_delete()					*mdnotes.formatting.hyperlink_delete()*

    Remove the hyperlink from the current hyperlink under the cursor.

hyperlink_toggle()					*mdnotes.formatting.hyperlink_toggle()*

    Toggle adding or removing the hyperlink. When adding it uses
    |mdnotes.hyperlink_insert()| and when removing it uses
    |mdnotes.hyperlink_delete()|.

bold_toggle()						*mdnotes.formatting.bold_toggle()*

    Toggle Markdown `**bold**` syntax. Select a word and execute the command
    or hover over already bold text to remove.

italic_toggle()						*mdnotes.formatting.italic_toggle()*

    Toggle Markdown `*italic*` syntax. Select a word and execute the command
    or hover over already bold text to remove.

strikethrough_toggle()					*mdnotes.formatting.strikethrough_toggle()*

    Toggle Markdown `~~strikethrough~~` syntax. Select a word and execute the 
    command or hover over already bold text to remove.

inline_code_toggle()					*mdnotes.formatting.inline_code_toggle()*

    Toggle Markdown `inline code` (``) syntax. Select a word and execute the command
    or hover over already bold text to remove.

task_list_toggle({line1}, {line2})			*mdnotes.formatting.task_list_toggle()*

    Toggle through checked, unchecked, and no checkbox in a list item. Also works
    with |linewise-visual|.

    Parameters: ~
    • {line1}  `(integer?)` Starting line number.
    • {line2}  `(integer?)` Ending line number.

generate()						*mdnotes.toc.generate()*

    Generate and insert a Table Of Contents of the current file at the cursor
    position.

create({rows}, {cols})					*mdnotes.tables.create()*

   Create a table of the size {rows} x {cols}. It will get populated with
   `ROWrCOLc` text automatically. If not arguments are given then a 3 x 3
   table is created. For example on a 3 x 3 table, it would be, 
>
    |1r1c|1r2c|1r3c|
    |----|----|----|
    |2r1c|2r2c|2r3c|
    |3r1c|3r2c|3r3c|

best_fit()						*mdnotes.tables.best_fit()*

   Set the best fit per column of your table so that they are all even.

table_column_insert_left()				*mdnotes.tables.column_insert_left()*

   Insert a column to the left of the current column you're in.

table_column_insert_right()				*mdnotes.tables.column_insert_right()*

   Insert a column to the right of the current column you're in.

patterns						*mdnotes.patterns*

    Format patterns are Lua patterns used to detect the existance of those
    formats at the current cursor position. The patterns must return start
    and end cursor positions (e.g. `"()~~(.-)~~()"`). 
    See |mdnotes.check_md_format()|

vim:tw=78:ts=8:expandtab:noet:ft=help:norl:
