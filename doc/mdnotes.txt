*mdnotes.txt*         Markdown Notes for Neovim (mdnotes.nvim)

Authors:
    Yiannis Michael (yimich9963)
                                       Type |gO| to see the table of contents.

==============================================================================
INTRODUCTION						*mdnotes-intro*

Markdown Notes (mdnotes or Mdn) is a plugin that aims to improve the Neovim
Markdown note-taking experience by providing features like better Wikilink
support, adding/removing hyperlinks to images/files/URLs, file history, asset
management, referencing, and formatting. All this without relying
on any LSP but using one is recommended.

==============================================================================
QUICK START            	             			*mdnotes-quickstart*

To setup `mdnotes` using the Lazy package manager, put this in your `init.lua` file,
>lua
    {
	"ymich9963/mdnotes.nvim",
    }

optionally specifying all the path and file options will allow you to use all
the commnds,
>lua
    {
	"ymich9963/mdnotes.nvim",
	opts = {
	    assets_path = "assets",
	    index_file = "MAIN.md",
	    journal_file = "JOURNAL.md",
	}
    }

Install and then setup using,
>lua
    require('mdnotes.config').setup({
	    assets_path = "assets",
	    index_file = "MAIN.md",
	    journal_file = "JOURNAL.md",
	})

Explanation for the options is given in the next |mdnotes-config| section.
See |mdnotes-keymaps| for keymap recommendations, |mdnotes-lsp| for notes on
using LSPs with `mdnotes`, and |mdnotes-completion| for using file name
completion.

==============================================================================
KEYMAPS            	             			*mdnotes-keymaps*

There aren't any default keymaps for `mdnotes` but some recommended ones might
be,
>lua
    vim.keymap.set('n', 'gf', ':Mdn open_wikilink<CR>', { buffer = true, desc = "Open markdown file from Wikilink" })
    vim.keymap.set({"v", "n"}, "<C-K>", ":Mdn hyperlink_toggle<CR>", { buffer = true, desc = "Toggle hyperlink" })
    vim.keymap.set("n", "<Left>", ":Mdn go_back<CR>", { buffer = true, desc = "Go to back to previously visited Markdown buffer" })
    vim.keymap.set("n", "<Right>", ":Mdn go_forward<CR>", { buffer = true, desc = "Go to next visited Markdown buffer" })
    vim.keymap.set({"v", "n"}, "<C-B>", ":Mdn bold_toggle<CR>", { buffer = true, desc = "Toggle bold formatting" })
    vim.keymap.set({"v", "n"}, "<C-I>", ":Mdn italic_toggle<CR>", { buffer = true, desc = "Toggle italic formatting" })

Note: It is highly recommended you have your keymaps in your
`after/ftplugin/markdown.lua` file to keep them specific to Markdown files.

==============================================================================
LSP            	             				*mdnotes-lsp*

This plugin was designed to use as few LSP features as possible and if any of
the Markdown LSPs improve over time then this plugin will be adapted to those
improvements. I recommend trying out marksman or markdown-oxide. 

With markdown-oxide, currently working LSP functions for me are,
|vim.lsp.buf.rename()| and |vim.lsp.buf.references()|. The first one only
seems to rename the current buffer and not the element (or link in this case)
under the cursor.

These functions are implemented in `mdnotes` with |:Mdn-rename_link_references|
and |:Mdn-show_references| respectively. The first function both renames the
reference and the file it is pointing to.

Quick tip is if you don't want your Markdown LSP to show diagnostics you can
disable LSP diagnostics per filetype by using this in your
`after/ftplugin/markdown.lua` file.
>lua
    vim.diagnostic.enable(false, { bufnr = 0 })

==============================================================================
COMPLETION            	         			*mdnotes-completion*

Built-in file path completion with Neovim can be used with `mdnotes` which
also means that you don't need an LSP for this either. Execute the completion
by typing the path and in insert mode pressing |i_CTRL-X_CTRL-F|.

For Windows, due to the square brackets being in |'isfname'|, you need to
remove them for autocompletion to work. Therefore put this in your
`after/ftplugin/markdown.lua`,
>lua
    vim.opt.isfname:remove('[')
    vim.opt.isfname:remove(']')

==============================================================================
CONFIG             	                     	      	*mdnotes-config*

The default config for `mdnotes` is shown below,
>lua
    {
	index_file = "",
	journal_file = "",
	assets_path = "",
	insert_file_behaviour = "copy",
	overwrite_behaviour = "error",
	open_behaviour = "buffer",
	bold_format = "**",
	italic_format = "*",
	date_format = "%a %d %b %Y",
	prefer_lsp = true,
	auto_list = true,
	default_keymaps = false,
    }
<
index_file = `"path"`					*mdnotes-index_file*

    Can be any path to your index file which is then accessed by |:Mdn-home|.

journal_file = `"path"`					*mdnotes-journal_file*

    Can be any path to your journal file which is then accessed by |:Mdn journal|.

assets_path = `"path"`					*mdnotes-assets_path*

    Can be any path to your assets folder. This is where any asset you insert
    by using |:Mdn insert_image| or |:Mdn insert_file| is copied or moved to.

insert_file_behaviour = `"string"`			*mdnotes-insert_file_behaviour*

    Can take the values of `"copy"` or `"move"` which copies or moves inserted
    assets respectively.

overwrite_behaviour = `"string"`			*mdnotes-overwrite_behaviour*

    Can take the values of `"error"` or `"overwrite"` which defines how the plugin 
    should handle existing assets. With `"error"` it throws an error and prevents
    the user from inserting the asset. With `"overwrite"` it will overwrite the
    conflicting file.

open_behaviour = `"string"`				*mdnotes-open_behaviour*

    Can take the values of `"buffer"` or `"tab"` which defines how Wikilinks are
    opened using |:Mdn home|, |:Mdn journal|, and |:Mdn open_wikilink|. With
    `"buffer"` it opens them in the current buffer, whereas with `"tab"` it opens them
    in a new tab.

bold_format = `"string"`				*mdnotes-bold_format*

    Can take the valid values of `"**"` or `"__"` which defines how the
    Markdown `**bold**` or `__bold__` formatting is executed.

italic_format = `"string"`				*mdnotes-italic_format*

    Can take the valid values of `"*"` or `"_"` which defines how the
    Markdown `*italic*` or `_italic_` formatting is executed.

date_format = `"string"`				*mdnotes-date_format*

    Format of the outputed date using |Mdn-insert_journal_entry|. See |strftime()| for
    acceptable formats.

prefer_lsp = `false|true`				*mdnotes-prefer_lsp*

    Choose whether to prefer to use the LSP functions instead of the `mdnotes`
    functions, when an LSP server is detected in the current Markdown buffer.

auto_list = `false|true`				*mdnotes-auto_list*

    Choose whether to allow automatic continuation of your unordered/ordered/
    task list. Works by remapping |<CR>|, |o|, and |O| but only in Markdown
    buffers by specifying it in the plugin's `after/ftplugin/markdown.lua`
    directory.

default_keymaps = `false|true`				*mdnotes-default_keymaps*

    Enable or disable the default keymaps listed in |mdnotes-keymaps|.

==============================================================================
COMMANDS                                         	*mdnotes-commands*

The Mdnotes plugin uses subcommands through calling `:Mdn <sub command>`. The
subcommands are listed below.

:Mdn home 	                                       	*:Mdn-home*

    Opens the index file depending on |mdnotes-open_behaviour|

:Mdn journal 	                                      	*:Mdn-journal*

    Opens the journal file depending on |mdnotes-open_behaviour|

:Mdn open 	                                      	*:Mdn-open*

    Opens the asset under the cursor. Uses |vim.ui.open()| but due to a bug for
    Winows it's currently using, >lua
	vim.system({"cmd.exe", "/c", "start", link}) 

:Mdn open_wikilink 					*:Mdn-open_wikilink*

    Open the Wikilink (e.g. `[[link]]` or `[[link#section]]`) under the cursor. 

:Mdn hyperlink_toggle 					*:Mdn-hyperlink_toggle*

    Toggle inserting and deleting a hyperlink (e.g. `[text](link)`) from your
    clipboard (the `"+` register).

:Mdn show_references 					*:Mdn-show_references*

    Show the references of the current Wikilink under cursor in a quickfix
    list. If no Wikilink is under the cursor it shows the references to the
    current buffer.

:Mdn outliner_toggle					*:Mdn-outliner_toggle*

    Toggle an outliner mode (similar to programs like Logseq). This command
    essentially creates or deletes certain keymaps to create the outliner mode.

:Mdn insert_image					*:Mdn-insert_image*

    Insert the image in the clipboard under the cursor and depending on
    |mdnotes-insert_file_behaviour| place it in your |mdnotes-assets_path|. (e.g
    `![image](path/to/assets/image.png)`). Overwriting depends on
    |mdnotes-overwrite_behaviour|.

:Mdn insert_file					*:Mdn-insert_file*

    Exactly the same as |Mdn-insert_image| but it inserts a hyperlink to the
    file (e.g. `[file](path/to/assets/file.txt)`).

:Mdn go_back						*:Mdn-go_back*

    Go back to the previously visited Markdown buffer.

:Mdn go_forward						*:Mdn-go_forward*

    Go forward to the Markdown buffer you were in before you went back.

:Mdn clear_history					*:Mdn-clear_history*

    Clear the history of visited Markdown buffers.

:Mdn cleanup_unused_assets				*:Mdn-cleanup_unused_assets*

    Cleanup unused assets in your |mdnnote-assets_path|. A |vim.ui.input()|
    will be used to prompt for `y/n/a(ll)` or `cancel` deletion actions. Uses
    |vim.fs.rm()|.

    Note: Data loss will obviously happen with this command so BE CAREFUL.

:Mdn move_unused_assets					*:Mdn-move_unused_assets*

    Move unused assets in your |mdnnote-assets_path| to an `../unused_assets/` 
    folder relative to your assets folder. A |vim.ui.input()| will be used 
    to prompt for `y/n/a(ll)` or `cancel` deletion actions. Uses |vim.fs.rm()|.

:Mdn rename_link_references				*:Mdn-rename_link_references*

    Rename the reference to a `[[link]]` and also the file pointing to that
    link.

:Mdn rename_references_cur_buf				*:Mdn-rename_references_cur_buf*

    Rename references to current buffer and also the file of the current
    buffer.

:Mdn bold_toggle					*:Mdn-bold_toggle*

    Toggle Markdown `**bold**` syntax. Select a word and execute the command
    or hover over already bold text to remove.

:Mdn italic_toggle					*:Mdn-italic_toggle*

    Toggle Markdown `*italic*` syntax. Select a word and execute the command
    or hover over already bold text to remove.

:Mdn strikethrough_toggle				*:Mdn-strikethrough_toggle*

    Toggle Markdown `~~strikethrough~~` syntax. Select a word and execute the 
    command or hover over already bold text to remove.

:Mdn inline_code_toggle					*:Mdn-inline_code_toggle*

    Toggle Markdown `inline code` (``) syntax. Select a word and execute the command
    or hover over already bold text to remove.

:Mdn task_list_toggle					*:Mdn-task_list_toggle*

    Toggle through checked, unchecked, and no checkbox in a list item. Also works
    with |linewise-visual|.

:Mdn insert_journal_entry				*:Mdn-insert_journal_entry*

    Insert at the top of the file the current date and time along with a separator.
    Useful when using a journal.

:Mdn generate_toc					*:Mdn-generate_toc*

    Generate and insert a Table Of Contents of the current file at the cursor 
    position.

==============================================================================
API                                     		*mdnotes-api*

`mdnotes` is not a complex plugin so most of the commands is just calling
their corresponding functions. Some of the descriptions here are copied from
the |mdnotes-commands| section.

setup({opts})                                          	*mdnotes.setup()*

    Configure installation with non-default options. Not needed if using
    defaults. See |mdnotes-config| for a more in-depth explanation.

    Parameters: ~
    • {opts}  `(table?)` Optional parameters:
              • {index_file} (`string?`, default `""`)
		path to index file.
              • {journal_file} (`string?`, default `""`)
		path to journal file.
              • {assets_path} (`string?`, default `""`)
		path to assets directory.
              • {insert_file_behaviour} (`string?`, default `"copy"`)
		`mdnotes` behaviour when inserting files.
              • {overwrite_behaviour} (`string?`, default `"copy"`)
		`mdnotes` behaviour when inserting files and the file already
		exists.
              • {open_behaviour} (`string?`, default `"copy"`)
		`mdnotes` behaviour when opening files with |:Mdn-open|.
              • {bold_format} (`string?`, default `"**"`)
		defines `mdnotes` bold formatting behaviour
              • {italic_format} (`string?`, default `"*"`)
		defines `mdnotes` italic formatting behaviour

format_patterns						*mdnotes.format_patterns*

    Format patterns are Lua patterns used to detect the existance of those
    formats at the current cursor position. The patterns must return start
    and end cursor positions (e.g. `"()~~(.-)~~()"`). 
    See |mdnotes.check_md_format()|

check_md_format({pattern}) 				*mdnotes.check_md_format()*

    Check if the text under cursor obeys a Lua pattern that is used to
    describe Markdown formatting. Patterns used are the
    |mdnotes.format_patterns|.

    Parameters: ~
    • {pattern}  `(string?)` A Lua pattern that also returns cursor position
      at the start and end.

    Return: ~
      (`false|true`)

check_assets_path() 					*mdnotes.check_assets_path()*

    Check the existance of the |mdnotes-assets_path| when inserting images or
    files.

    Return: ~
      (`false|true`)

open() 							*mdnotes.open()*

    Open the hyperlink under cursor. It can be a file or a URL.

go_to_index_file() 			   		*mdnotes.go_to_index_file()*

    Go the index file defined by |mdnotes-index_file|.

go_to_journal_file()					*mdnotes.go_to_journal_file()*

    Go the journal file defined by |mdnotes-journal_file|.

open_wikilink()						*mdnotes.open_wikilink()*

    Open Wikilink under cursor (e.g. `[[link#section]]`).

hyperlink_insert()					*mdnotes.hyperlink_insert()*

    Insert a hyperlink from the clipbaord using the currently highlighted
    word.

hyperlink_delete()					*mdnotes.hyperlink_delete()*

    Remove the hyperlink from the current hyperlink under the cursor.

hyperlink_toggle()					*mdnotes.hyperlink_toggle()*

    Toggle adding or removing the hyperlink. When adding it uses
    |mdnotes.hyperlink_insert()| and when removing it uses
    |mdnotes.hyperlink_delete()|.

show_references()					*mdnotes.show_references()*

    Show the references of the current Wikilink under cursor in a quickfix
    list. If no Wikilink is under the cursor it shows the references to the
    current buffer.

outliner_toggle()					*mdnotes.outliner_toggle()*

    Toggle the outliner mode. Outliner mode essentially sets or deletes
    certain keymaps to simulate working in an outliner program (e.g. Logseq).

buf_history						*mdnotes.buf_history*

    Table containing the sequential buffer history of the visited Markdown
    buffers. It gets populated through an `autocmd` on a `BufEnter` event. If
    the user goes back and then goes forward to buffer that they were not
    previously in, the buffer history removes everything past the buffer they
    went back to, and appends the buffer they've moved forward to.

current_index						*mdnotes.current_index*

    Current index being pointed to in the |mdnotes.buf_history| table. 

go_back()						*mdnotes.go_back()*

    Go back in the buffer history. Essentially move the index by -1. See
    |mdnotes.buf_history|.

go_forward()						*mdnotes.go_forward()*

    Go forward in the buffer history. Essentially move the index by +1. See
    |mdnotes.buf_history|.

clear_history()						*mdnotes.clear_history()*

    Clear the |mdnotes.buf_history| table.

insert_image()						*mdnotes.insert_image()*

    Insert the image in the clipboard under the cursor and depending on
    |mdnotes-insert_file_behaviour| place it in your |mdnotes-assets_path|. (e.g
    `![image](path/to/assets/image.png)`). Overwriting depends on
    |mdnotes-overwrite_behaviour|.


insert_file()						*mdnotes.insert_file()*

    Exactly the same as |mdnotes.insert_image()| but it inserts a hyperlink to the
    file (e.g. `[file](path/to/assets/file.txt)`).

insert_journal_entry()					*mdnotes.insert_journal_entry()*

    Insert a journal entry at the top of the file, which is the current date 
    along with a separator to separate the different entries. Places the 
    cursor on `<cursor>`. For example,
>markdown
    ```
    Sun 09 Nov 2025

    <cursor>

    ---
    ```

cleanup_unused_assets()					*mdnotes.cleanup_unused_assets()*

    Cleanup unused assets in your |mdnnote-assets_path|. A |vim.ui.input()|
    will be used to prompt for `y/n/a(ll)` or `cancel` deletion actions. Uses
    |vim.fs.rm()|.

    Note: Data loss will obviously happen with this command so BE CAREFUL.

move_unused_assets()					*mdnotes.move_unused_assets()*

    Move unused assets in your |mdnnote-assets_path| to an `../unused_assets/` 
    folder relative to your assets folder. A |vim.ui.input()| will be used 
    to prompt for `y/n/a(ll)` or `cancel` move actions. Uses |uv.fs_rename()|.

rename_link_references()				*mdnotes.rename_link_references()*

    Rename the reference to a `[[link]]` and also the file pointing to that
    link.

rename_references_cur_buf()				*mdnotes.rename_references_cur_buf()*

    Rename references to current buffer and also the file of the current
    buffer.

bold_toggle()						*mdnotes.bold_toggle()*

    Toggle Markdown `**bold**` syntax. Select a word and execute the command
    or hover over already bold text to remove.

italic_toggle()						*mdnotes.italic_toggle()*

    Toggle Markdown `*italic*` syntax. Select a word and execute the command
    or hover over already bold text to remove.

strikethrough_toggle()					*mdnotes.strikethrough_toggle()*

    Toggle Markdown `~~strikethrough~~` syntax. Select a word and execute the 
    command or hover over already bold text to remove.

inline_code_toggle()					*mdnotes.inline_code_toggle()*

    Toggle Markdown `inline code` (``) syntax. Select a word and execute the command
    or hover over already bold text to remove.

task_list_toggle({line1}, {line2})			*mdnotes.task_list_toggle()*

    Toggle through checked, unchecked, and no checkbox in a list item. Also works
    with |linewise-visual|.

    Parameters: ~
    • {line1}  `(integer?)` Starting line number.
    • {line2}  `(integer?)` Ending line number.

generate_toc()						*mdnotes.generate_toc()*

    Generate and insert a Table Of Contents of the current file at the cursor
    position.

vim:tw=78:ts=8:expandtab:noet:ft=help:norl:
